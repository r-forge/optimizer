parh2 <- rawh/sum(rawh)
parh2
?sd
te <- nleqslv(x, enll.g)
pare <- te$x/sum(te$x)
cat("nleqslv: rescaled parameter mean=", mean(pare)," with SD=",sd(pare),"\n")
ne<-nlfb(strt, enll.g, trace=1)
rawe <- coef(ne)
pare2 <- rawe/sum(rawe)
cat("nlsr: rescaled parameter mean=", mean(pare2)," with SD=",sd(pare2),"\n")
cat("\nNow 100 parameters\n")
xh<-1:100
teh <- nleqslv(xh, enll.g)
teh
parh <- teh$x/sum(teh$x)
cat("nlsr: rescaled parameter mean=", mean(parh)," with SD=",sd(parh),"\n")
nh<-nlfb(xh, enll.g)
rawh <- coef(nh)
rawh
parh2 <- rawh/sum(rawh)
parh2
cat("\nNow 100 parameters\n")
xh<-1:100
teh <- nleqslv(xh, enll.g)
teh
parh <- teh$x/sum(teh$x)
parh <- teh$x/sum(teh$x)
cat("nleqslv: rescaled parameter mean=", mean(parh)," with SD=",sd(parh),"\n")
nh<-nlfb(xh, enll.g)
rawh <- coef(nh)
rawh
parh2 <- rawh/sum(rawh)
cat("nleqslv: rescaled parameter mean=", mean(parh2)," with SD=",sd(parh2),"\n")
library(nleqslv)
library(nlsr)
cat("Problem of order 5 using nll.g\n")
x<-1:5
tn <- nleqslv(x, nll.g)
tn
parn <- tn$x/sum(tn$x)
cat("nleqslv: rescaled parameter mean=", mean(parn)," with SD=",sd(parn),"\n")
cat("Problem of order 5 using enll.g\n")
te <- nleqslv(x, enll.g)
cat("Problem of order 5 using nll.g\n")
x<-1:5
tn <- nleqslv(x, nll.g)
parn <- tn$x/sum(tn$x)
cat("nleqslv: rescaled parameter mean=", mean(parn)," with SD=",sd(parn),"\n")
cat("Problem of order 5 using enll.g\n")
te <- nleqslv(x, enll.g)
pare <- te$x/sum(te$x)
cat("nleqslv: rescaled parameter mean=", mean(pare)," with SD=",sd(pare),"\n")
ne<-nlfb(strt, enll.g, trace=1)
rawe <- coef(ne)
pare2 <- rawe/sum(rawe)
cat("nlsr: rescaled parameter mean=", mean(pare2)," with SD=",sd(pare2),"\n")
cat("\nNow 100 parameters using enll.g\n")
xh<-1:100
teh <- nleqslv(xh, enll.g)
parh <- teh$x/sum(teh$x)
cat("nleqslv: rescaled parameter mean=", mean(parh)," with SD=",sd(parh),"\n")
nh<-nlfb(xh, enll.g)
rawh <- coef(nh)
parh2 <- rawh/sum(rawh)
cat("nleqslv: rescaled parameter mean=", mean(parh2)," with SD=",sd(parh2),"\n")
nh<-nlfb(xh, enll.g, trace=FALSE)
nh<-nlfb(xh, enll.g, trace=0)
library(nlmrt)
cat("Problem of order 5 using nll.g\n")
x<-1:5
tn <- nleqslv(x, nll.g)
parn <- tn$x/sum(tn$x)
cat("nleqslv: rescaled parameter mean=", mean(parn)," with SD=",sd(parn),"\n")
cat("Problem of order 5 using enll.g\n")
te <- nleqslv(x, enll.g)
pare <- te$x/sum(te$x)
cat("nleqslv: rescaled parameter mean=", mean(pare)," with SD=",sd(pare),"\n")
ne<-nlfb(strt, enll.g, trace=1)
ne<-nlfb(strt, enll.g, trace=0)
rawe <- coef(ne)
pare2 <- rawe/sum(rawe)
cat("nlsr: rescaled parameter mean=", mean(pare2)," with SD=",sd(pare2),"\n")
cat("\nNow 100 parameters using enll.g\n")
xh<-1:100
teh <- nleqslv(xh, enll.g)
parh <- teh$x/sum(teh$x)
cat("nleqslv: rescaled parameter mean=", mean(parh)," with SD=",sd(parh),"\n")
nh<-nlfb(xh, enll.g, trace=0)
rawh <- coef(nh)
parh2 <- rawh/sum(rawh)
cat("nleqslv: rescaled parameter mean=", mean(parh2)," with SD=",sd(parh2),"\n")
n<-5
sd()
n<-5
enew <- function(lx){
n <- length(lx)
x <- exp(lx)
scale <- sum( (1:n) * x^2)
obj <- log(scale) - sum(log(x))
}
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
n
lo
up
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
libary(optimrx)
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
libary(optimrx)
library(optimrx)
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
parm2
parm2 <- parm2/sqrt(scale(parm2))
print(parm2)
parm2
parm2 <- amsk2[1, 1:n]
parm2
scale(parm2)
parm2 <- amsk2[1, 1:n]
xx <- parm2
xx
xy <- (1:n)*xx^2
xy
names(xy)<-NULL
xy
sum(xy)
sqrt(sum(xy))
scale(xx)
xx <- c(1,2)
scale <- 1 + 2*4
scale
obj <- 2
xy <- xx/sqrt(9)
xy
prod(xy)
sum(log(xy))
sum(log(xx))
-sum(log(xx))+log(3)
-sum(log(xx))+log(9)
xy <- xx/sqrt(9)
sum(log(xx))
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(lx){
n <- length(lx)
x <- exp(lx)
obj <- log(scale) - sum(log(x))
}
library(optimrx)
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
parm2 <- parm2/sqrt(scale(parm2))
print(parm2)
library(optimrx)
strt <- (1:n)/(2*n)
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(lx){
n <- length(lx)
x <- exp(lx)
obj <- log(scale) - sum(log(x))
}
library(optimrx)
n <- 5
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
mset<-c("L-BFGS-B", "spg", "nlm", "nlminb", "Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mset)
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
parm2 <- parm2/sqrt(scale(parm2))
print(parm2)
cat("enew(parm2)=", enew(parm2),"\n")
print(exp(parm2))
print(parm2e)
parm2e<-exp(parm2)
print(parm2e)
cat("enew(parm2)=", enew(parm2),"\n")
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(lx){
n <- length(lx)
x <- exp(lx)
obj <- log(scale(x)) - sum(log(x))
}
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
parm2 <- parm2/sqrt(scale(parm2))
parm2e<-exp(parm2)
print(parm2e)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2e))
parm2e
amsk2[1, 1:n]
raw <- amsk2[1, 1:n]
raw <- as.numeric(raw)
raw
# these are log(parameters)
rawp <- exp(raw)
rawp
sqrt(exp(1))
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(lx){
n <- length(lx)
x <- exp(lx)
sc <- sqrt(scale(x))
#  obj <- - sum(log(x/sc))
obj <- 0.5*n*log(sc)-sum(log(x))
}
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
parm2 <- parm2/sqrt(scale(parm2))
parm2e<-exp(parm2)
print(parm2e)
parm2e<-as.numeric(exp(parm2))
print(parm2e)
cat("enew(parm2)=", enew(parm2),"\n")
rm(list=ls())
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(lx){
n <- length(lx)
x <- exp(lx)
sc <- sqrt(scale(x))
#  obj <- - sum(log(x/sc))
obj <- 0.5*n*log(sc)-sum(log(x))
}
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enll, enll.g, lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
parm2 <- parm2/sqrt(scale(parm2))
parm2e<-as.numeric(exp(parm2))
print(parm2e)
cat("enew(parm2)=", enew(parm2),"\n")
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(lx){
n <- length(lx)
x <- exp(lx)
sc <- sqrt(scale(x))
#  obj <- - sum(log(x/sc))
obj <- 0.5*n*log(sc)-sum(log(x))
}
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enew, gr="grcentral", lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
parm2 <- parm2/sqrt(scale(parm2))
parm2e<-as.numeric(exp(parm2))
print(parm2e)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2e))
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(x){
n <- length(x)
##  x <- exp(lx)
sc <- sqrt(scale(x))
#  obj <- - sum(log(x/sc))
obj <- 0.5*n*log(sc)-sum(log(x))
}
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enew, gr="grcentral", lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
amsk2 <- opm(strt, enew, gr="grcentral", method=mmth)
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(x){
n <- length(x)
##  x <- exp(lx)
sc <- sqrt(scale(x))
#  obj <- - sum(log(x/sc))
obj <- n*log(sc)-sum(log(x))
}
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
amsk2 <- opm(strt, enew, gr="grcentral", method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
parm2 <- parm2/sqrt(scale(parm2))
parm2e<-as.numeric(exp(parm2))
print(parm2e)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2e))
print(parm2)
cat("enew(parm2)=", enew(parm2),"\n")
parm2 <- amsk2[1, 1:n]
print(parm2)
parm2 <- as.numeric(parm2/sqrt(scale(parm2)))
print(parm2)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2))
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enew, gr="grcentral", lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
print(parm2)
parm2 <- as.numeric(parm2/sqrt(scale(parm2)))
print(parm2)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2))
areg<- opm(strt, enew, gr="grnd", method=mmth)
areg
print(amsk2)
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(x){
n <- length(x)
##  x <- exp(lx)
sc <- sqrt(scale(x))
obj <- - sum(log(x/sc))
#  obj <- n*log(sc)-sum(log(x))
}
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enew, gr="grcentral", lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
print(parm2)
parm2 <- as.numeric(parm2/sqrt(scale(parm2)))
print(parm2)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2))
areg<- opm(strt, enew, gr="grnd", method=mmth)
areg
pc<- as.numeric(areg[2, 1:5])
pv<- as.numeric(areg[1, 1:5])
pc
pv
scc <- scale(pc)
scc
scale(pc)
pc <- pc/sqrt(pc)
scale(pc)
pc <- pc/sqrt(pc)
pv
scale(pc)
scv <- scale(pv)
scv
pv <- pv/sqrt(pv)
pv
scale(pv)
print(scale(parm2))
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enew, gr="grcentral", lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
print(parm2)
parm2 <- as.numeric(parm2/sqrt(scale(parm2)))
print(parm2)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2))
areg<- opm(strt, enew, gr="grnd", method=mmth)
areg
pc<- as.numeric(areg[2, 1:5])
scale <- function(x) {sum( (1:n) * x^2)}
enew <- function(x){
n <- length(x)
##  x <- exp(lx)
sc <- sqrt(scale(x))
obj <- - sum(log(x/sc))
#  obj <- n*log(sc)-sum(log(x))
}
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enew, gr="grcentral", lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
print(parm2)
parm2 <- as.numeric(parm2/sqrt(scale(parm2)))
print(parm2)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2))
areg<- opm(strt, enew, gr="grnd", method=mmth)
areg
pc<- as.numeric(areg[2, 1:5])
pv<- as.numeric(areg[1, 1:5])
pc
pv
scc <- scale(pc)
scc
pc <- pc/sqrt(pc)
pc
scale(pc)
parm2
parm2/pc
areg<- opm(strt, enew, gr="grnd", method=mmth)
areg
pc<- as.numeric(areg[2, 1:5])
pv<- as.numeric(areg[1, 1:5])
pc
pv
scc <- scale(pc)
scc
pc <- pc/sqrt(scc)
pc
scale(pc)
scv <- scale(pv)
scv
pv <- pv/sqrt(scv)
pv
scale(pv)
?Rvmmin
library(optimrx)
n <- 5
mmth<-c("Rvmmin", "Rcgmin")
mset<-c("Rcgmin", "ucminf", "Nelder-Mead")
strt <- (1:n)/(2*n)
lo <- c(rep(-100, (n-1)),strt[n])
up <- c(rep(100, (n-1)),strt[n])
amsk2 <- opm(strt, enew, gr="grcentral", lower=lo, upper=up, method=mmth)
amsk2 <- summary(amsk2, order=value)
print(amsk2)
parm2 <- amsk2[1, 1:n]
print(parm2)
parm2 <- as.numeric(parm2/sqrt(scale(parm2)))
print(parm2)
cat("enew(parm2)=", enew(parm2),"\n")
print(scale(parm2))
areg<- opm(strt, enew, gr="grnd", method=mset)
areg
for (ii in 1:dim(areg)[1]){
prm <- areg[ii,1:5]
print(prm)
prm<-as.numeric(prm/sqrt(scale(prm)))
cat("scaled parameters:")
print(prm)
cat("new scale=", scale(prm),"\n")
}
