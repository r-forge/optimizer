require(pracma)
?brentDekker
?newton
?brentDekker
?newton
?regulaFalsi
require(rootSolve)
citation("rootSolve")
citation("rootSolve", bibtex=TRUE)
print(citation("rootSolve"), bibtex=TRUE)
muller
?muller
?muller
?uniroot
##
aint <- function(x, R) { # Mortgage rate per month calculation
val <- (1 + x/100)^6 - (1 + R/200)
}
require(Rmpfr)
require(pracma)
a <- 0
b <- 100 # upper limit on interest!
x0 <- 1 # starting value for Newton
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
rdir <- (1 + R/200)^(1/6)
ru <- uniroot(aint, lower=a, upper= b)
cat("R = ",R,"   rdir = ",rdir,"\n")
cat("ru:")
print(ru)
}
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
rdir <- (1 + R/200)^(1/6)
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir,"\n")
cat("ru:")
print(ru)
}
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
rdir <- 100*( (1 + R/200)^(1/6) - 1) # Nasty subtraction
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir,"\n")
cat("ru:")
print(ru)
}
?newton
?brent
require(pracma)
a <- 0
b <- 100 # upper limit on interest!
x0 <- 1 # starting value for Newton
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
rdir <- 100*( (1 + R/200)^(1/6) - 1) # Nasty subtraction
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir)
cat("  ru(",ru$iter,") ",ru$root)
rn <- pracma::newton(aint, x0)
cat("  rn(",rn$iter,") ",rn$root)
rb <- pracma::brent(aint, a,b)
cat("  rb(",rb$iter,") ",rb$root)
rn <- pracma::ridder(aint, a, b)
cat("  rr(",rr$iter,") ",rn$root)
rm <- pracma::muller(aint,  a,b)
cat("rm(",rm$iter,") ",rm$root)
cat("\n")
}
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
rdir <- 100*( (1 + R/200)^(1/6) - 1) # Nasty subtraction
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir)
cat("  ru(",ru$iter,") ",ru$root)
rn <- pracma::newton(aint, x0, R=R)
cat("  rn(",rn$iter,") ",rn$root)
rb <- pracma::brent(aint, a,b, R=R)
cat("  rb(",rb$iter,") ",rb$root)
rn <- pracma::ridder(aint, a, b, R=R)
cat("  rr(",rr$iter,") ",rn$root)
rm <- pracma::muller(aint,  a,b, R=R)
cat("rm(",rm$iter,") ",rm$root)
cat("\n")
}
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
aintR <- function(x){ aint(x, R=R)}
rdir <- 100*( (1 + R/200)^(1/6) - 1) # Nasty subtraction
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir)
cat("  ru(",ru$iter,") ",ru$root)
rn <- pracma::newton(aintR, x0)
cat("  rn(",rn$iter,") ",rn$root)
rb <- pracma::brent(aintR, a,b)
cat("  rb(",rb$iter,") ",rb$root)
rn <- pracma::ridder(aintR, a, b)
cat("  rr(",rr$iter,") ",rn$root)
rm <- pracma::muller(aintR,  a,b)
cat("rm(",rm$iter,") ",rm$root)
cat("\n")
}
?ridder
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
aintR <- function(x){ aint(x, R=R)}
rdir <- 100*( (1 + R/200)^(1/6) - 1) # Nasty subtraction
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir)
cat("  ru(",ru$iter,") ",ru$root)
rn <- pracma::newton(aintR, x0)
cat("  rn(",rn$iter,") ",rn$root)
rb <- pracma::brent(aintR, a,b)
cat("  rb(",rb$iter,") ",rb$root)
rn <- pracma::ridders(aintR, a, b)
cat("  rr(",rr$iter,") ",rn$root)
rm <- pracma::muller(aintR,  a,b)
cat("rm(",rm$iter,") ",rm$root)
cat("\n")
}
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
aintR <- function(x){ aint(x, R=R)}
rdir <- 100*( (1 + R/200)^(1/6) - 1) # Nasty subtraction
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir)
cat("  ru(",ru$iter,") ",ru$root)
rn <- pracma::newton(aintR, x0)
cat("  rn(",rn$iter,") ",rn$root)
rb <- pracma::brent(aintR, a,b)
cat("  rb(",rb$iter,") ",rb$root)
rr <- pracma::ridders(aintR, a, b)
cat("  rr(",rr$iter,") ",rn$root)
rm <- pracma::muller(aintR,  a,b)
cat("rm(",rm$iter,") ",rm$root)
cat("\n")
}
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
aintR <- function(x){ aint(x, R=R)}
rdir <- 100*( (1 + R/200)^(1/6) - 1) # Nasty subtraction
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir)
cat("  ru(",ru$iter,") ",ru$root)
rn <- pracma::newton(aintR, x0)
cat("  rn(",rn$iter,") ",rn$root)
rb <- pracma::brent(aintR, a,b)
cat("  rb(",rb$iter,") ",rb$root)
rr <- pracma::ridders(aintR, a, b)
cat("  rr(",rr$iter,") ",rn$root)
rm <- pracma::muller(aintR,  a,b)
cat("  rm(",rm$iter,") ",rm$root)
cat("\n")
}
?muller
x0 <- 1 # starting value for Newton
for (R in c(20, 10, 5, 2.5, 1.25, .8, .5, .3, .1)){
aintR <- function(x){ aint(x, R=R)}
rdir <- 100*( (1 + R/200)^(1/6) - 1) # Nasty subtraction
ru <- uniroot(aint, lower=a, upper= b, R=R)
cat("R = ",R,"   rdir = ",rdir)
cat("  ru(",ru$iter,") ",ru$root)
rn <- pracma::newton(aintR, x0)
cat("  rn(",rn$iter,") ",rn$root)
rb <- pracma::brent(aintR, a,b)
cat("  rb(",rb$iter,") ",rb$root)
rr <- pracma::ridders(aintR, a, b)
cat("  rr(",rr$iter,") ",rn$root)
###    rm <- pracma::muller(aintR,  a,b) # COMPLEX RESULT!
###    cat("  rm(",rm$iter,") ",rm$root)
cat("\n")
}
