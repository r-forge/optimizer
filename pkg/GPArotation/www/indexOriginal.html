
<html>
<head>
<link rel="stylesheet" href="Global.css">
<br />
<b>Warning</b>:  mysql_connect() [<a href='function.mysql-connect'>function.mysql-connect</a>]: Can't connect to local MySQL server through socket '/var/mysql/mysql.sock' (2) in <b>/usr/local/lib/php/common.php</b> on line <b>25</b><br />
<br />
<b>Warning</b>:  mysql_db_query(): supplied argument is not a valid MySQL-Link resource in <b>/usr/local/lib/php/common.php</b> on line <b>29</b><br />
<br />
<b>Warning</b>:  mysql_num_rows(): supplied argument is not a valid MySQL result resource in <b>/usr/local/lib/php/common.php</b> on line <b>30</b><br />
<br />
<b>Warning</b>:  mysql_db_query(): supplied argument is not a valid MySQL-Link resource in <b>/usr/local/lib/php/common.php</b> on line <b>47</b><br />
<br />
<b>Warning</b>:  mysql_close(): supplied argument is not a valid MySQL-Link resource in <b>/usr/local/lib/php/common.php</b> on line <b>48</b><br />
<title>Gradient Projection Algorithms</title>
</head>
<body>

<h1>Gradient Projection Algorithms</h1>

<h2>Gradient Projection Algorithms and Software for Arbitrary Rotation Criteria in Factor Analysis</h2>

<h3>Index</h3>



1. <a href="#1">Introduction</a>
<br>
2. <a href="#2">Algorithms using explicit derivatives</a>
<br>
3. <a href="#3">Derivative free algorithms for factor analysis</a>
<br>
4. <a href="#4">General GP algorithms</a>
<br>
5. <a href="#5">How to produce a random starting matrix?</a>

<h2>
1. <a NAME="1">Introduction</a>
</h2>

Gradient Projection algorithms are a general class of algorithms that can be
used to optimize virtually any rotation criterion. Here algorithms and rotation criteria
are available for download in <b>Matlab</b>, <b>Splus</b> and
<b>R</b>, <b>SAS PROC IML</b>, and <b>SPSS</b> matrix language format. 
<br><br>
The following rotation methods have been implemented:<br>
Bentler's invariant pattern simplicity, biquartimax (oblimin with gamma=.5), 
biquartimin (oblimin with gamma=.5), Crawford-Ferguson, equamax (oblimin with gamma=p/2), 
factor parsimony (Crawford-Ferguson with kappa=1), geomin, infomax,
minimum entropy, McCammon minimum entropy ratio,
oblimax, oblimin, orthomax (orthogonal oblimin), parsimax
(Crawford-Ferguson with kappa=(k-1)/(p+k-2)),
partially specified target rotation, promax, quartimax, quartimin, 
simplimax, tandem principle I and tandem principle II, target rotation, varimax.<br>
<br>
A list of references to the criteria is <a href="references.pdf">[PDF] here</a>.
<br><br>
Gradient projection algorithms are designed to optimize any rotation criterion. See the programs
and subroutines for examples. 
<br><br>
Details of the algorithms, and the correct reference for the software is:<br>
Bernaards, C.A. and Jennrich, R.I. (2005)
Gradient Projection Algorithms and Software for  Arbitrary
Rotation Criteria in Factor Analysis. <i>Educational and Psychological
Measurement, 65 (5)</i>, 676-696. (<a href="http://epm.sagepub.com/cgi/content/abstract/65/5/676">abstract</a>)
<br><br>
<b>
The software may be distributed free of charge and used by anyone
if credit is given. It has been tested in several situations, 
but it comes with no guarantees and the authors assume no liability for its use or misuse.
By downloading and/or using this software you agree to these statements.</b><br><br>

<h2>
2. <a name="2">Algorithms using explicit derivatives</a>
</h2>

The correct reference for this software is: <br>
Bernaards, C.A. and Jennrich, R.I. (2005)
Gradient Projection Algorithms and Software for  Arbitrary
Rotation Criteria in Factor Analysis. <i>Educational and Psychological
Measurement, 65 (5)</i>, 676-696. (Email one of the authors for a copy, 
<a href="http://epm.sagepub.com/cgi/content/abstract/65/5/676">abstract</a>).
<br><br>
A quick overview is available on <a href="jsm2003.pdf">[PDF] slides from JSM 2003</a>.
<br><br>
Theory of gradient projection algorithms may be found in:<br>
Jennrich, R.I. (2001). A simple general procedure for orthogonal rotation.  <i>Psychometrika</i>, 66, 289-306.<br>
Jennrich, R.I. (2002). A simple general method for oblique rotation.  <i>Psychometrika</i>, 67, 7-19.
<br><br>
<b>Matlab</b><br> The Matlab source code consists of one file with 
both gradient projection algorithms in it.  Also, a number of 
popular and less known rotation criteria are provided.
<a href="matlab.net">Here</a> is the Matlab implementation.
<br><br>

<b>Splus</b><br> The Splus code can be sourced which will give the main algorithms,
one for orthogonal and one for oblique rotation. Also, a number of 
popular and less known rotation criteria are provided.
<a href="splusfunctions.net">Here</a> is the Splus implementation.
<br><br>

<b>R</b><br> 
An R library is available from <a href="http://cran.us.r-project.org/src/contrib/Descriptions/GPArotation.html">CRAN</a>. 
The library is clean, and has help files. Alternatively, <a href="splusfunctions.net">this older code</a> 
may be sourced but it is less clean.
<br><br>

<b>SAS PROC IML</b><br> The SAS PROC IML code is divided over two files. 
<a href="orthogonal.SAS">Orthogonal.SAS</a> has the orthogonal
rotation algorithm and a number of criteria. 
<a href="oblique.SAS">Oblique.SAS</a> has the oblique 
rotation algorithm with its criteria. 
<br><br>

<b>SPSS Matrix language</b><br> The SPSS code is divided over two files. 
<a href="orthogonal.SPS">Orthogonal.SPS</a> has the orthogonal
rotation algorithm applied to a number of criteria. 
<a href="oblique.SPS">Oblique.SPS</a> has the oblique 
rotation algorithm applied to a number of criteria.
<br>
Note that in SPSS each criteria has its own implementation of the GPF algorithm. 
Also, within each algorithm the criteria appears at two spots. Adding a new criterion
requires that its implementation is changed at both places. The implementation for
simplimax appears to work but relies on round-offs in order to serve as an artificial
SIGN function. If you have a better implementation email one of the authors. 
<br><br>

<b>Stata</b> <br>
Stata 9 appears to have the GPF algorithms and most of the rotation criteria implemented in the <a href="http://www.stata.com/help.cgi?rotate">rotate</a> and the <a href="http://www.stata.com/help.cgi?rotatemat">rotatemat</a> commands. 
Another implementation of Oblimin has been written by Herve Caci, and may
be downloaded from <a href="http://perso.wanadoo.fr/herve.caci">Herve's homepage</a>.
<br><br>

<b>Gauss</b><br>
Li Cai has translated the algorithms into Gauss. The implementation may be downloaded from
<a href="http://www.unc.edu/~lcai/programs.html">Li's homepage</a>.<br><br>

<h2>
3. <a name="3">Derivative free algorithms for factor analysis</a>
</h2>

This implementation does not use an explicit derivative but uses numerical derivates.
This algorithm is discussed in:<br>
Jennrich, R.I. (2004). Derivative Free Gradient Projection Algorithms for Rotation.</a>
<i>Psychometrika</i>, 69, 475-480.
<br><br>
<b>Matlab</b><br> A <a href="GPderfree.txt">Matlab</a> implementation, with a
<a href="web.pdf">[PDF] detailed example</a>. It has the main algorithms, and quartimin and quartimax.
<br><br>

<b>Splus and R</b><br> An implementation for <a href="splusfunctions.derfree">Splus/R</a>
with most of the methods listed above.

<h2>
4. <a name="4">General GP algorithms</a>
</h2>

While by far their most common application, the original gradient projection algorithms 
of Jennrich (2000, 2001) were not restricted to rotation. They could, for example, be used 
to optimize the DEDICOM criterion, to simultaneously diagonalize several symmetric 
matrices (See, e.g., Jennrich, 2000), or be used for other non-factor analysis applications. 
What follows is a description of some specific Matlab code for  the general orthogonal and 
oblique algorithms together with examples of their use. Also given is editable code that 
may be used directly. The advantage of the factor analysis versions is that they are 
easier to use for factor analysis applications.<br><br>

<a href="generalGP.pdf">[PDF] Discussion of the Matlab code and examples.</a><br><br>

<a href="GPeditable.txt">Editable code (text-file).<a><br><br>

<h2>
5. <a name="5">How to produce a random starting matrix?</a>
</h2>

For criteria used here, it may be useful to consider more than one starting value for the rotation. 
The identity matrix is used by default. Here we provide functions to obtain a random orthogonal 
k by k matrix. That is a random orthogonal matrix uniformily 
distributed over the group of k by k orthogonal matricies. The codes 
are very brief.<br><br>

<b>Matlab</b><br> The Matlab source code consists of one file with the random start algorithm.
<a href="randomstart.matlab">Here</a> is the Matlab implementation.
<br><br>

<b>Splus and R</b><br> The Splus code can be sourced, and will provide the function Random.Start.
<a href="randomstart.splus">Here</a> is the Splus/R implementation.
<br><br>

<b>SAS PROC IML</b><br> The SAS code results in a random matrix called rm.
<a href="randomstart.SAS">Here</a> is the SAS PROC IML implementation.
<br><br>

<b>SPSS Matrix language</b><br> The SPSS code results in a random matrix called Tmat.
<a href="randomstart.SPS">Here</a> is the SPSS matrix language
implementation. Disclaimer: this procedure is based on uniform random
variable draws, not on normally distributed random
variables. Therefore, the resulting random matrices may not be
uniformly distributed over all orthogonal random matrices
(but they are random).
<br><br>

<b>Stata</b><br> Stata 9 has a random start option built in, see 
<a href="http://www.stata.com/help.cgi?rotatemat#optimizeopts">the optimization options</a>
included in the <a href="http://www.stata.com/help.cgi?rotatemat">rotatemat command</a>.
<br><br>

Investigators: <a href="mailto:coenb@gene.com">Coen A. Bernaards</a>
and <a href="mailto:rij@stat.ucla.edu">Robert I. Jennrich</a>.

<div style="font-size: 10px; text-align: right;">
<hr style="width:40%; text-align:right; margin-right:0;" align="right"/>
<div style="font-weight:bold;">
   <a href="http://www.stat.ucla.edu" target="_top">UCLA Department of Statistics</a>
</div>
Last updated: 03-Nov-2005<br/>  Access count is: 1, since <br/>
Maintained by: <a href="http://www.stat.ucla.edu/" target="_top">Coen A. Bernaards and Robert I. Jennrich</a> [<a href="mailto:webstaff@stat.ucla.edu">webstaff@stat.ucla.edu</a>]
</div>
</body>
</html>

